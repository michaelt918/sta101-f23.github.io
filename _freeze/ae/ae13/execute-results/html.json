{
  "hash": "3ca90b2de550fc6b6ca76a8ec9156176",
  "result": {
    "markdown": "---\ntitle: \"The Normal Distribution\"\nsubtitle: \"STA 101\"\nformat: html\n---\n\n\n## Bulletin\n\n- Mid-semester grades posted\n- Regression project **due Saturday October 15**\n\n## Today\n\nBy the end of today you will...\n\n- define **stable distribution**, **normal distribution**, **location** and **scale** parameters\n- plot normal distributions and calculate probabilities\n\n## Getting started\n\nDownload this application exercise by pasting the code below into your **console**\n\n```\ndownload.file(\"https://sta101-fa22.netlify.app/static/appex/ae13.qmd\",\ndestfile = \"ae13.qmd\")\n```\n\n## Load packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n## Normal distribution\n\nThe **normal distribution**, also known as \"Gaussian distribution\" is a distribution of a continuous random variable. The sample space of a normal random variable is $\\{- \\infty, + \\infty \\}$ and is defined by two parameters: a mean $\\mu$ and a standard deviation $\\sigma$. The mean is known as the **location** parameter while the standard deviation is the **scale**.\n\nWe can sample `N` times from a normal with mean `mu` and standard deviation `sigma` using `rnorm(n = N, mean = mu, sd = sigma)`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n# example\nsample = rnorm(1000, mean = 0, sd = 1)\n\nmean(sample)\nsd(sample)\n\nhist(sample)\n```\n:::\n\n\n\nLet's visualize the normal function curve using the code below.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmu1 = 100\ns1 = 6\n\nmu2 = 105\ns2 = 3\n\nggplot(data = data.frame(x = c(mu1 - s1*3, mu1 + s1*3)), aes(x = x)) +\n  stat_function(fun = dnorm, args = list(mean = mu1, sd = s1),\n                color = \"steelblue\") +\n  stat_function(fun = dnorm, args = list(mean = mu2, sd = s2),\n                color = \"orange\") + \n  theme_bw() +\n  labs(title = \"Two normal curves\")\n```\n\n::: {.cell-output-display}\n![](ae13_files/figure-html/visualize-normal-1.png){width=672}\n:::\n:::\n\n\n#### Exercise 1\n\nTry setting `mu2` to 99 and `s2` to 4. What do you notice? Play with a few more settings and describe what the mean and standard deviation do to the shape of the curve.\n\n#### Exercise 2\n\nStart with the code below of a histogram but change your geometry to `geom_histogram(aes(y = ..density..))`. This will re-scale your histogram so that the area under the curve is 1. Next, use the `stat_function` code above as a template to superimpose a normal distribution on top of your histogram. Adjust the mean and standard deviation until you obtain a good looking fit. What do you notice?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1013)\nx = rbinom(n = 10000, size = 100, prob = 0.8)\ndf = data.frame(x) \n\ndf %>%\n  ggplot(aes(x = x)) + \n  geom_histogram(bins = 35) +\n  theme_bw() +\n  labs(x = \"X\", title = \"Distribution of heads in 100 biased coin flips\")\n```\n:::\n\n\n\n## Properties of a Gaussian\n\nIf $X$ is a random variable, and $X$ is normally distributed, then it the distribution of $X$ is fully specified by the **location** (mean) and **scale** (standard deviation) parameters, $\\mu$ and $\\sigma$ respectively. In mathematical notation we write\n\n$$\nX \\sim N(\\mu, \\sigma)\n$$\nand this reads: \"X is normally distributed with mean mu and standard deviation sigma.\" It is worth noting that in **some contexts** (see e.g. \"notation\" on [wikipedia](https://en.wikipedia.org/wiki/Normal_distribution)) the second term of a Normal distribution refers to the variance or $\\sigma^2$. \n\nA very useful property of Normal distribution is that it is **stable**. What this means is that linear combinations of normal random variables are themselves normal. In other words, if $X$ and $Y$ are normal random variables then $aX + bY$ is normal for all $a$ and $b$. The two properties to remember when adding Gaussian random variables are:\n\n- mean(X + Y) = mean(X) + mean(Y)\n- variance(X + Y) = variance(X) + variance(Y) when X and Y are independent\n\nWe can see this in an example.\n\nLet $X \\sim N(5, 3)$ and let $Y \\sim N(-5, 1)$\n\nAccording to our rules above $X + Y \\sim N(0, \\sqrt{10})$. Let's check ourselves with code:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nnormal_df = data.frame(X = rnorm(1000, mean = 5, sd = 3),\n                 Y = rnorm(1000, mean = -5, sd = 1))\n\n\n\nnormal_df = normal_df %>%\n  mutate(Z = X + Y)\n\nnormal_df %>%\n  ggplot(aes(x = Z)) +\n  geom_histogram(aes(y = ..density..), fill = 'gold3', alpha = 0.5) +\n  theme_bw() +\n  labs(y = \"Density\", title = \"Matching densities\") +\n  stat_function(fun = dnorm, args = list(mean = 0, sd = sqrt(10)),\n                color = \"darkblue\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.\nâ„¹ Please use `after_stat(density)` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](ae13_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n#### Exercise 3\n\nLet $Z \\sim N(0, 1)$ and $X \\sim N(10, 4)$\n\n$aZ + b \\stackrel{d}{=} X$ for some $a$ and $b$. What are $a$ and $b$? Fill them in for the `?` in the code below and the uncomment the code. Here \"$\\stackrel{d}{=}$ means \"equal in distribution\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nnormal_df = data.frame(z = rnorm(1000, mean = 0, sd = 1),\n                 x = rnorm(1000, mean = 10, sd = 4))\n\nsample_mean = normal_df %>%\n  summarize(sample_mean = mean(x)) %>%\n  pull()\n\nnormal_df %>%\n  ggplot(aes(x = x)) +\n  geom_histogram(aes(y = ..density..), fill = 'gold3', alpha = 0.5) +\n  geom_histogram(aes(x = z, y = ..density..), fill = 'steelblue', alpha = 0.7) +\n  #geom_density(aes(x = z*? + ?), color = 'red') + \n  theme_bw() +\n  labs(x = \"\", y = \"\", title = \"Sampling from two normals\")\n```\n:::\n\n\n## Computing probabilities\n\n`pnorm` \"probability normal\" takes three arguments:\n\n- `q`, `mean` and `sd`\n\nand `pnorm(q = q, mean = mu, sd = sigma)` answers the question:\n\nIf $X \\sim N(\\mu, \\sigma)$, what is $p(X < q)$?\n\nFor example, imagine that the resting heart rates in the classroom are normally distributed with mean 70 beats per minute (bpm) and standard deviation 5 bpm. What's the probability a randomly selected individual has a heart rate less than 63 bpm?\n\nIn math: let $X$ be the bpm of an individual in this class. Assume $X \\sim N(70, 5)$. What is $p(X < 63)$? Given heartbeats are normally distributed, randomly selecting an individual from the classroom is called \"drawing from a normal distribution\".\n\nWe can compute this easily:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(63, 70, 5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.08075666\n```\n:::\n:::\n\n\n0.08 or about 8% chance. In picture, the probability is the proportion of area under the curve shaded:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](ae13_files/figure-html/proportion-shaded-1.png){width=672}\n:::\n:::\n\n\n#### Exercise 4\n\nWhat is the probability a randomly selected student in the class has a heart beat greater than 75 bpm?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# code here\n```\n:::",
    "supporting": [
      "ae13_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}